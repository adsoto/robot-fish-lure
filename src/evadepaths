"""file defines the pathbounds of the new evasion path, also defines the fish radius
sends different paths to controller based on the position and robot + fish"""
import math
import random
import numpy as np
# import controller
# import convert
import math

# from controller import robot_pos

#DELETE THESE
#LAIR 
#X DIR CONVERSTIONS
xoff = 574
xslope = 1151

#Y DIR CONVERSIONS
yoff = 762
yslope = (-1156)


def xpxtomet(xpix):
    xadjust = xpix - xoff  # accounts for offset in px - origin on the left side of the tank
    x_met = ((xadjust/xslope) + 0.49) # adjust origin to lower left IN METERS
    return x_met

def ypxtomet(ypix):
    yadjust = ypix - yoff # accounts for offset in px and moves origin to lower left corner or tank
    y_met = ((yadjust/yslope) - 0.3)  # adjust  origin to lower left IN METERS
    return y_met

def ymettopx(ymet):
    y_px = (ymet+0.3) * yslope
    yadjust = y_px + yoff
    return yadjust

def xmettopx(xmet):
    x_px = (xmet -0.49) * xslope
    xadjust = x_px + xoff
    return xadjust


def createbounds(bounds):
    # CONVERT TO MET TO MATCH PATHS AND robot_pos
    x1_met = xpxtomet(float(bounds[0][0]))
    y1_met = ypxtomet(float(bounds[0][1]))
    x2_met = xpxtomet(float(bounds[1][0]))
    y2_met = ypxtomet(float(bounds[1][1]))
    return x1_met, y1_met, x2_met, y2_met

def createcorners(x1_met,y1_met,x2_met,y2_met): # PASS METER VALUES HERE
    """creates corners of the tank for the robot to search in -- reassigns origin to lower left corner, matching robot position in meters"""

    height_met = abs(y2_met - y1_met) # 13in ish - good
    width_met= abs(x2_met - x1_met)  # 27.25in ish - good
    x1_met = 0 # sets left wall to be x = 0
    y1_met = height_met
    x2_met = width_met
    y2_met = 0 #set the bottom to be y = 0
    listcorners = [[0,0], [0,y1_met], [x2_met,y1_met], [x2_met,0]]
    return listcorners #in meters!!!

def cornerdist(robot_pos, listofcorners):
    distlist = []
    mindist = 10000 #arbitrary
    for i in listofcorners:
        dist = [i,math.dist(robot_pos, i)]
        distlist += [dist]
    return distlist

# tankboundspx = controller.bounds
bounds = ([[ 687 ,396],[1483 ,801]])
tankboundspx = bounds

robot_pos = [0.02,0.33] ##EVENTUALLY IMPORT FROM CONTROLLER

x1_met, y1_met, x2_met, y2_met = createbounds(tankboundspx)
listcorners = createcorners(x1_met, y1_met, x2_met, y2_met)
distlist = cornerdist(robot_pos, listcorners)


robot_x_met = robot_pos[0]
robot_y_met = robot_pos[1]
print(robot_pos)
print(robot_x_met, robot_y_met)

if 0 <= robot_x_met <= 0.05 and 0 <= robot_y_met <= 0.05:
    print("check for fish in bottom left corner")

if 0 <= robot_x_met <= 0.05  and  0.3 <= robot_y_met <= 0.35:
    print("check for fish in top left corner")

if 0.64 <= robot_x_met <= 0.69  and  0.3 <= robot_y_met <= 0.35:
    print("check for fish in top right corner")

if 0.64 <= robot_x_met <= 0.69  and  0 <= robot_y_met <= 0.05:
    print("check for fish in bottom right corner")

# continue path?!?

print()
print(listcorners)

# newpathbounds = np.array([[x1_met, y1_met], [x2_met, y2_met]])
# print(newpathbounds)

# for i in range(5):
#     fish_pos = [random.randint(0,10), random.randint(0,10)]
#     robot_pos = [random.randint(0,10), random.randint(0,10)]

#     print("robot position is", robot_pos)
#     print("fish position is", fish_pos)
#     dist = math.dist(robot_pos,fish_pos)

#     if dist < 7:
#         print("switch to other path")
#     else:
#         print("no fish in range")
#     print()




